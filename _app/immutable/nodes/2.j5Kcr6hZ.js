import{t as h,a as v}from"../chunks/BaqBsVXD.js";import{i as w}from"../chunks/D6Q9veTw.js";import{p as x,t as b,a as E,s as n,m as y,b as D,c as l,r as d,g as $}from"../chunks/DsRcb7Gy.js";import{s as k}from"../chunks/DqyIA5kh.js";import{o as O}from"../chunks/CGCl-dIc.js";var P=h('<main class="svelte-xbkpxr"><h1>True North Compass</h1> <div class="compass svelte-xbkpxr"> </div></main>');function q(m,g){x(g,!1);let o=y("Waiting for data..."),r=0;async function p(e,t){try{const a=await fetch(`https://www.ngdc.noaa.gov/geomag-web/calculators/calculateDeclination?lat1=${e}&lon1=${t}&resultFormat=json`);if(!a.ok)throw new Error("Failed to get magnetic declination");return(await a.json()).result[0].declination}catch(a){return console.error("Error fetching magnetic declination:",a),0}}function u(){function e(t){let c=(t.alpha+r+360)%360;n(o,`True North: ${c.toFixed(2)}Â°`)}typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"?window.addEventListener("deviceorientation",e):n(o,"Permission denied")}).catch(t=>{n(o,`Error: ${t.message}`)}):window.addEventListener("deviceorientation",e)}O(()=>{if(!navigator.geolocation){n(o,"Geolocation not supported");return}navigator.geolocation.getCurrentPosition(async e=>{const{latitude:t,longitude:a}=e.coords;r=await p(t,a),u()},e=>{n(o,`Geolocation error: ${e.message}`)},{enableHighAccuracy:!0})}),w();var i=P(),s=D(l(i),2),f=l(s,!0);d(s),d(i),b(()=>k(f,$(o))),v(m,i),E()}export{q as component};
