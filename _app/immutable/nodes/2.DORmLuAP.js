import{t as P,b as z}from"../chunks/BK42vEmR.js";import{y as G,F as Q,n as q,B as x,h as j,o as ee,O as a,X as re,Y as ae,Z as V,m as R,p as T,q as te,_ as X,z as J,$ as ne,a0 as N,w as K,f as $,a1 as se,a2 as ie,a3 as F,a4 as le,a5 as oe,v as fe,a6 as ve,J as ue,a7 as de,a8 as ce,j as _e,i as he,A as pe,a9 as k,aa as ge,V as Y,C as ye,ab as I,K as O,L as w,W as D}from"../chunks/EkEFrnbx.js";import{s as H}from"../chunks/CoI4bZYX.js";import{o as me}from"../chunks/DJRSYPYo.js";function xe(i,r){return r}function Ae(i,r,n,f){for(var d=[],e=r.length,u=0;u<e;u++)oe(r[u].e,d,!0);var h=e>0&&d.length===0&&n!==null;if(h){var c=n.parentNode;fe(c),c.append(n),f.clear(),E(i,r[0].prev,r[e-1].next)}ve(d,()=>{for(var p=0;p<e;p++){var t=r[p];h||(f.delete(t.k),E(i,t.prev,t.next)),ue(t.e,!h)}})}function Ee(i,r,n,f,d,e=null){var u=i,h={flags:r,items:new Map,first:null};{var c=i;u=x?q(j(c)):c.appendChild(G())}x&&ee();var p=null,t=!1,m=re(()=>{var s=n();return he(s)?s:s==null?[]:K(s)});Q(()=>{var s=a(m),v=s.length;if(t&&v===0)return;t=v===0;let o=!1;if(x){var _=u.data===ae;_!==(v===0)&&(u=V(),q(u),R(!1),o=!0)}if(x){for(var g=null,l,y=0;y<v;y++){if(T.nodeType===8&&T.data===te){u=T,o=!0,R(!1);break}var M=s[y],b=f(M,y);l=U(T,h,g,null,M,b,y,d,r,n),h.items.set(b,l),g=l}v>0&&q(V())}x||be(s,h,u,d,r,f,n),e!==null&&(v===0?p?X(p):p=J(()=>e(u)):p!==null&&ne(p,()=>{p=null})),o&&R(!0),a(m)}),x&&(u=T)}function be(i,r,n,f,d,e,u){var h=i.length,c=r.items,p=r.first,t=p,m,s=null,v=[],o=[],_,g,l,y;for(y=0;y<h;y+=1){if(_=i[y],g=e(_,y),l=c.get(g),l===void 0){var M=t?t.e.nodes_start:n;s=U(M,r,s,s===null?r.first:s.next,_,g,y,f,d,u),c.set(g,s),v=[],o=[],t=s.next;continue}if(Me(l,_,y),(l.e.f&N)!==0&&X(l.e),l!==t){if(m!==void 0&&m.has(l)){if(v.length<o.length){var b=o[0],A;s=b.prev;var L=v[0],S=v[v.length-1];for(A=0;A<v.length;A+=1)B(v[A],b,n);for(A=0;A<o.length;A+=1)m.delete(o[A]);E(r,L.prev,S.next),E(r,s,L),E(r,S,b),t=b,s=S,y-=1,v=[],o=[]}else m.delete(l),B(l,t,n),E(r,l.prev,l.next),E(r,l,s===null?r.first:s.next),E(r,s,l),s=l;continue}for(v=[],o=[];t!==null&&t.k!==g;)(t.e.f&N)===0&&(m??(m=new Set)).add(t),o.push(t),t=t.next;if(t===null)continue;l=t}v.push(l),s=l,t=l.next}if(t!==null||m!==void 0){for(var C=m===void 0?[]:K(m);t!==null;)(t.e.f&N)===0&&C.push(t),t=t.next;var W=C.length;if(W>0){var Z=h===0?n:null;Ae(r,C,Z,c)}}$.first=r.first&&r.first.e,$.last=s&&s.e}function Me(i,r,n,f){se(i.v,r),i.i=n}function U(i,r,n,f,d,e,u,h,c,p){var t=(c&de)!==0,m=(c&ce)===0,s=t?m?ie(d):F(d):d,v=(c&le)===0?u:F(u),o={i:v,v:s,k:e,a:null,e:null,prev:n,next:f};try{return o.e=J(()=>h(i,s,v,p),x),o.e.prev=n&&n.e,o.e.next=f&&f.e,n===null?r.first=o:(n.next=o,n.e.next=o.e),f!==null&&(f.prev=o,f.e.prev=o.e),o}finally{}}function B(i,r,n){for(var f=i.next?i.next.e.nodes_start:n,d=r?r.e.nodes_start:n,e=i.e.nodes_start;e!==f;){var u=_e(e);d.before(e),e=u}}function E(i,r,n){r===null?i.first=n:(r.next=n,r.e.next=n&&n.e),n!==null&&(n.prev=r,n.e.prev=r&&r.e)}function we(i,r){return i==null?null:String(i)}function Te(i,r,n,f){var d=i.__style;if(x||d!==r){var e=we(r);(!x||e!==i.getAttribute("style"))&&(e==null?i.removeAttribute("style"):i.style.cssText=e),i.__style=r}return f}var Ie=P('<div class="qVal"> </div>'),Oe=P('<main class="svelte-1sjg2gt"><h2> </h2> <div class="shell svelte-1sjg2gt"><div class="compass svelte-1sjg2gt"></div></div> <div class="message"> </div> <div class="quaternion"></div></main>');function Ne(i,r){pe(r,!0);let n="Compass",f=k(""),d=k(15),e=k(ge([]));function u(_,g=0){return Math.round(_*Math.pow(10,g))/Math.pow(10,g)}me(()=>{if("AbsoluteOrientationSensor"in window)try{const _=new AbsoluteOrientationSensor({frequency:1,referenceFrame:"screen"});_.addEventListener("reading",()=>{I(e,_.quaternion,!0);const l=new DOMMatrixReadOnly([1-2*(a(e)[1]**2+a(e)[2]**2),2*(a(e)[0]*a(e)[1]-a(e)[2]*a(e)[3]),2*(a(e)[0]*a(e)[2]+a(e)[1]*a(e)[3]),0,2*(a(e)[0]*a(e)[1]+a(e)[2]*a(e)[3]),1-2*(a(e)[0]**2+a(e)[2]**2),2*(a(e)[1]*a(e)[2]-a(e)[0]*a(e)[3]),0,2*(a(e)[0]*a(e)[2]-a(e)[1]*a(e)[3]),2*(a(e)[1]*a(e)[2]+a(e)[0]*a(e)[3]),1-2*(a(e)[0]**2+a(e)[1]**2),0,0,0,0,1]).transformPoint({x:0,y:0,z:-1});I(d,Math.atan2(l.x,l.z)*(180/Math.PI))}),_.addEventListener("error",g=>{console.error("Sensor error:",g),I(f,"error")}),_.start()}catch(_){console.error("Failed to initialize AbsoluteOrientationSensor:",_),I(f,"AbsoluteOrientationSensor is not supported or permission denied.")}else I(f,"AbsoluteOrientationSensor is not supported on this device")});var h=Oe(),c=O(h),p=O(c);w(c);var t=D(c,2),m=O(t);w(t);var s=D(t,2),v=O(s,!0);w(s);var o=D(s,2);Ee(o,21,()=>a(e),xe,(_,g)=>{var l=Ie(),y=O(l,!0);w(l),Y(M=>H(y,M),[()=>u(a(g),4)]),z(_,l)}),w(o),w(h),Y(()=>{H(p,`${n}: ${a(d)??""}`),Te(m,`rotate: ${a(d)??""}(deg);`),H(v,a(f))}),z(i,h),ye()}export{Ne as component};
